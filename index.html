<!DOCTYPE html>
<html>
<head>
<title>星星充电储能测算</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="text/javascript" src="https://public.tableau.com/javascripts/api/tableau-2.min.js"></script>
<style>
/* 通过CSS尽可能隐藏工具栏和按钮 */
.tabToolbarButton.shareDownload, .tabToolbarButton.tabAuthLink, .tabToolbarButton.openInNewTab {
    display: none !important;
}
</style>
<script type="text/javascript">
function initViz() {
    var containerDiv = document.getElementById("vizContainer"),
        url = "https://public.tableau.com/views/2_0_17151492395470/sheet2_1?:language=zh-CN&publish=yes&:sid=&:display_count=n&:origin=viz_share_link",
        options = {
            hideTabs: true,
            hideToolbar: true,
            onFirstInteractive: function () {
                console.log("Run this code when the viz has finished loading.");
                // 定期隐藏工具栏和按钮
                intervalHide();
            }
        };

    // 创建并嵌入视图
    var viz = new tableau.Viz(containerDiv, url, options);
}

function intervalHide() {
    var checkExist = setInterval(function() {
        var toolbarButtons = document.querySelectorAll('.tabToolbarButton');
        if (toolbarButtons.length) {
            toolbarButtons.forEach(function(button) {
                button.style.display = 'none';
            });
            clearInterval(checkExist);
        }
    }, 100); // 每100毫秒检查一次
}
</script>
</head>
<body onload="initViz();">
<div id="vizContainer" style="width:800px; height:700px;"></div>
</body>
</html>
